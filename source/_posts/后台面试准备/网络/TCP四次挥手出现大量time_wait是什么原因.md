---
title: TCP四次挥手出现大量time_wait是什么原因
---

TIME_WAIT产生条件：TCP四次挥手中，第一个发送FIN=1的TCP报文的人称为主动关闭者，主动关闭者在发送四次挥手最后一个ACK后会变成TIME_WAIT状态，持续时间为2MSL（linux一个MSL为30s，不可配置）

TIME_WAIT持续两个MSL的作用：

1、可靠安全关闭TCP连接，比如网络拥塞，如果主动关闭方最后一个ACK没有被关闭方接收到（它怎么知道有没有被关闭方收到？？），这时被动关闭方会对FIN超时重传，这时尚未关闭的TIME_WAIT就会把这些尾巴问题处理掉，不至于对新连接以及其他服务产生影响

2、防止由于没有持续的TIME_WAIT时间，导致新的TCP连接建立起来，延迟的FIN重传包会干扰新的连接。



